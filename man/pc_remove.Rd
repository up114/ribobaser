% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pc_remove.R
\name{pc_remove}
\alias{pc_remove}
\title{Principal-component removal for TE matrices (global or study-level)}
\usage{
pc_remove(
  te_mat,
  study_map = NULL,
  method = c("study", "global"),
  n_pcs = "auto",
  min_samples = 15
)
}
\arguments{
\item{te_mat}{numeric matrix, genes x samples. Row names = genes; col names = samples.}

\item{study_map}{optional data.frame with columns \code{Experiment} and \code{Study};
required when \code{method = "study"}. \code{Experiment} must match \code{colnames(te_mat)}.}

\item{method}{character, \code{"study"} (default) or \code{"global"}.}

\item{n_pcs}{\code{"auto"} (default) or non-negative integer.}

\item{min_samples}{integer; for \code{method="study"}, skip correction when a study
has fewer than this many samples. Default \code{15}.}
}
\value{
list with:
\itemize{
\item \code{te_corrected}: matrix (genes x samples), same dimnames as \code{te_mat}.
\item \code{n_pcs}: if global, an integer; if study, a data.frame with \code{Study} and \code{n_pcs}.
\item \code{dropped_genes}: character vector of genes dropped from SVD due to near-zero variance
(they are re-inserted unchanged in the output).
\item \code{params}: list of arguments used.
}
}
\description{
Remove leading principal components (PCs) from a translation efficiency (TE)
matrix to control unwanted sample-level structure. Works either globally
(one SVD across all samples) or per study (one SVD per study block).
}
\details{
\strong{Orientation}: input must be \emph{genes x samples} (matches \code{te()} output).

\strong{PC count}:
\itemize{
\item \code{n_pcs = "auto"} uses \code{sva::num.sv(..., method = "be")} like the reference scripts.
\item pass an integer to force a fixed number of PCs to remove.
}
}
\examples{
# Global correction, preserve CLR (good before TEC):
# out <- pc_remove(te_mat, method = "global")

}
